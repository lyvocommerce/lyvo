<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Lyvo ‚Äî Mini App</title>

  <!-- Telegram WebApp SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Tailwind build -->
  <link rel="stylesheet" href="css/styles.css"/>

  <!-- Base light theme tuning (Apple-like spacing/typography) -->
  <style>
    :root {
      --bg: #ffffff;
      --text: #1c1c1e;     /* iOS label color */
      --muted: #6e6e73;    /* iOS secondary label */
      --border: #e5e5ea;   /* iOS separator */
      --card: #f9f9fb;     /* subtle surface */
      --accent: #0071e3;   /* Apple blue */
    }
    body {
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      letter-spacing: -0.01em;
    }
    /* iOS-like focus ring */
    .focus-ring:focus {
      outline: 2px solid rgba(0,113,227,0.35);
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <div class="container mx-auto max-w-[720px] px-4 py-5">
    <!-- Header / Brand -->
    <header class="mb-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="h-9 w-9 rounded-xl bg-[var(--card)] border border-[var(--border)] grid place-items-center">
            <span class="text-lg">üõçÔ∏è</span>
          </div>
          <div>
            <h1 class="text-[22px] font-semibold tracking-tight">Lyvo</h1>
            <p class="text-[13px] text-[var(--muted)] leading-snug">
              Curated products inside Telegram
            </p>
          </div>
        </div>
        <a href="#" id="openChatTop"
           class="hidden md:inline-flex items-center gap-2 text-[var(--accent)] text-[14px] hover:opacity-80 focus-ring">
          Open chat
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M5 12h14M13 5l7 7-7 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
      </div>
    </header>

    <!-- Hero (subtle) -->
    <section class="rounded-2xl border border-[var(--border)] bg-[var(--card)] p-5 mb-5">
      <div class="flex flex-col gap-3">
        <h2 class="text-xl md:text-2xl font-semibold tracking-tight">Discover, compare, decide</h2>
        <p class="text-[14px] text-[var(--muted)]">
          Clean browsing experience, quick actions, and links that open where you prefer.
        </p>
        <div class="flex gap-3">
          <button id="openBtnHero"
                  class="px-4 py-2 rounded-md bg-[var(--accent)] text-white text-[14px] font-medium hover:opacity-90 focus-ring">
            Open store
          </button>
          <button id="testEventHero"
                  class="px-4 py-2 rounded-md border border-[var(--border)] text-[14px] hover:bg-white focus-ring">
            Send test event
          </button>
        </div>
      </div>
    </section>

    <!-- Optional welcome banner (revealed via ?startapp=welcome) -->
    <div id="welcome-banner"
         class="hidden rounded-xl border border-[var(--border)] p-4 mb-4 bg-white">
      <h3 class="text-[17px] font-semibold">Welcome to Lyvo</h3>
      <p class="mt-1 text-[13px] text-[var(--muted)]">
        To receive messages from Lyvo, tap <b>Start</b> in the chat.
      </p>
      <div class="mt-3 flex gap-2">
        <button id="open-chat"
                class="px-3 py-2 rounded-md border border-[var(--border)] text-[14px] hover:bg-white focus-ring">
          Open chat
        </button>
        <button id="dismiss"
                class="px-3 py-2 rounded-md border border-[var(--border)] text-[14px] hover:bg-white focus-ring">
          Got it
        </button>
      </div>
    </div>

    <!-- Controls -->
    <div class="flex flex-wrap items-center gap-2 mb-3">
      <div class="relative flex-1 min-w-[200px]">
        <input id="search" type="text" placeholder="Search products"
          class="w-full px-3 py-2 pr-9 rounded-md border border-[var(--border)] bg-white text-[15px] focus-ring"
        />
        <svg class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"
             width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M21 21l-4.3-4.3M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </div>
      <select id="sort"
        class="px-3 py-2 rounded-md border border-[var(--border)] bg-white text-[15px] focus-ring">
        <option value="">Sort</option>
        <option value="price_asc">Price: Low ‚Üí High</option>
        <option value="price_desc">Price: High ‚Üí Low</option>
        <option value="popular">Popular</option>
        <option value="newest">Newest</option>
      </select>
    </div>

    <!-- Categories -->
    <div id="cats" class="flex flex-wrap gap-8 mb-4">
      <!-- rendered by app.js -->
    </div>

    <!-- Grid -->
    <div id="grid" class="grid grid-cols-2 gap-4">
      <!-- rendered by app.js -->
    </div>

    <!-- Pagination -->
    <div class="flex items-center justify-between mt-6">
      <button id="prev"
        class="px-4 py-2 rounded-md border border-[var(--border)] bg-white text-[14px] focus-ring disabled:opacity-40">
        Prev
      </button>
      <span id="pageinfo" class="text-[13px] text-[var(--muted)]">Page 1</span>
      <button id="next"
        class="px-4 py-2 rounded-md border border-[var(--border)] bg-white text-[14px] focus-ring disabled:opacity-40">
        Next
      </button>
    </div>

    <!-- Footer -->
    <footer class="py-6 text-center text-[12px] text-[var(--muted)]">
      ¬© Lyvo. Early demo.
    </footer>
  </div>

  <!-- App logic -->
  <script src="js/app.js"></script>
  <script>
    // Wire hero buttons to existing app.js handlers
    (function () {
      const tg = window.Telegram?.WebApp;
      const open = document.getElementById('openBtnHero');
      const test = document.getElementById('testEventHero');
      if (open) {
        open.addEventListener('click', () => {
          try { tg?.openLink('https://lyvo.vercel.app', { try_instant_view: false }); }
          catch { window.open('https://lyvo.vercel.app','_blank'); }
        });
      }
      if (test) {
        test.addEventListener('click', () => {
          try {
            tg?.sendData(JSON.stringify({ event: 'demo_click', ts: Date.now() }));
            tg?.showPopup({ title: 'Sent', message: 'Event sent to bot', buttons:[{type:'close'}] });
          } catch (e) { console.log(e); }
        });
      }
      // Top-right "Open chat"
      const openChatTop = document.getElementById('openChatTop');
      if (openChatTop) {
        openChatTop.addEventListener('click', (e) => {
          e.preventDefault();
          const url = "https://t.me/LyvoShopBot?start=welcome";
          try { tg?.openLink(url); } catch { window.open(url, '_blank'); }
        });
      }
    })();
  </script>
</body>
</html>